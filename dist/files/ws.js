!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=52)}([function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);function o(t,e){for(var n=0;n<t.length;n++)e(t[n])}function i(t,e){var n=[];return o(t,function(t){return n.push(e(t))}),n}function a(t,e){var n=[];return o(t,function(t){return e(t)&&n.push(t)}),n}function s(t,e,n){if(0===t.length&&void 0===n){var r=new TypeError("Reduce of empty array with no initial value");throw c(r),r}for(var o=void 0===n?[t[0],1]:[n,0],i=o[0],a=o[1];a<t.length;a++)i=e(i,t[a]);return i}function u(t,e){for(var n in t)e(n,t[n])}function c(t){null!=console&&null!=console.log&&console.log(t)}function l(t){return Object.prototype.toString.call(t).slice(8,-1)}function p(t){return t.replace(/\W/g,function(t){return"\\u"+("000"+t.charCodeAt(0).toString(16)).slice(-4)})}e.decodeURIComponentOpt=function(t){try{return r.some(decodeURIComponent(t))}catch(t){return r.none}},e.decodeURIComponentOrNot=function(t){try{return decodeURIComponent(t)}catch(e){return t}},e.isNonNullable=function(t){return null!==t&&void 0!==t},e.isString=function(t){return"string"==typeof t},e.isNumber=function(t){return"number"==typeof t},e.trim=function(t){return t.replace(/^\s+|\s+$/g,"")},e.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},e.each=o,e.map=i,e.filter=a,e.filterDefined=function(t){var e=[];return o(t,function(t){return null!=t&&e.push(t)}),e},e.find=function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return r.some(t[n]);return r.none},e.reduce=s,e.exists=function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return!0;return!1},e.every=function(t,e){for(var n=0;n<t.length;n++)if(!e(t[n]))return!1;return!0},e.uniq=function(t){return s(t,function(t,e){return-1===t.indexOf(e)?t.concat([e]):t},[])},e.sort=function(t){return t.slice().sort(function(t,e){return t<e?-1:t>e?1:0})},e.eachProp=u,e.slim=function(t){var e={};return u(t,function(t,n){null!=n&&r.maybe(n,function(n){return n.forEach(function(n){return e[t]=n})},function(n){return e[t]=n})}),e},e.sum=function(t){return s(t,function(t,e){return t+e},0)},e.extend=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n={};return o(t,function(t){for(var e in t)n[e]=t[e]}),n},e.assertNotNull=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];o(t,function(t){if(null==t)throw new TypeError})},e.logError=c,e.makeJsonString=function t(e){switch(l(e)){case"Array":return"["+i(a(e,function(t){return void 0!==t}),t).join(",")+"]";case"Object":var n=[];for(var r in e)e.hasOwnProperty(r)&&void 0!==e[r]&&n.push('"'+p(r)+'":'+t(e[r]));return"{"+n.join(",")+"}";case"String":return'"'+p(e)+'"';case"Number":case"Boolean":return""+e;case"Null":return"null";case"Undefined":return"";default:return e.toString?'"'+p(e.toString())+'"':""+e}},e.getTypeString=l,e.jsonEscape=p,e.getRandomString=function(t){return Math.random().toString(36).slice(-1*t)}},function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0);function i(t){return null==t?e.none:new u(t)}function a(t){return new u(t)}e.maybe=function(t,e,n){return t instanceof s?e(t):n(t)},e.option=i,e.some=a,e.nonEmptyOption=function(t){return o.isNonNullable(t)&&0===t.length?e.none:i(t)};var s=function(){function t(){}return t.prototype.isDefined=function(){return"value"in this},t.prototype.exists=function(t){return this.isDefined()&&t(this.get())},t.prototype.flatMap=function(t){return this.isDefined()?t(this.get()):e.none},t.prototype.getOrElse=function(t){return this.isDefined()?this.get():t},t.prototype.fold=function(t,e){return this.isDefined()?e?e(this.get()):this.get():t()},t.prototype.forEach=function(t){this.isDefined()&&t(this.get())},t.prototype.filter=function(t){return this.exists(t)?this:e.none},t.prototype.map=function(t){return this.isDefined()?a(t(this.get())):e.none},t.prototype.orElse=function(t){return this.isDefined()?this:t},t.prototype.orElseLazy=function(t){return this.isDefined()?this:t()},t.prototype.isEmpty=function(){return!this.isDefined()},t.prototype.getOrElseLazy=function(t){return this.isDefined()?this.get():t()},t}();e.Option=s;var u=function(t){function e(e){var n=t.call(this)||this;return n.value=e,n}return r(e,t),e.prototype.get=function(){return this.value},e.prototype.toString=function(){return"Some("+this.value+")"},e}(s),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.toString=function(){return"None"},e}(s);e.none=new c},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);function o(t){return Array.prototype.slice.call(t)}function i(t,e){return(t.matches||t.matchesSelector||t.webkitMatchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||function(t){return-1!==o(this.ownerDocument.querySelectorAll(t)).indexOf(this)}).call(t,e)}e.setOnload=function(t,e){return t.onload=function(){return e()},t.onreadystatechange=function(){"loaded"!==t.readyState&&"complete"!==t.readyState||e()},t.onerror=function(){return e()},t},e.toArray=o,e.matches=i,e.isElement=function(t){return!!t&&1===t.nodeType},e.closest=function(t,e){var n=t.closest||function t(e){if(i(this,e))return this;var n=this.parentNode;return n&&1===n.nodeType?t.call(n,e):null};return r.option(n.call(t,e))},e.getTarget=function(t){var e=t.target||t.srcElement;return r.option(e)}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(1),i=function(){function t(t,e,n){r.assertNotNull(t),this.url=o.option(t.URL).flatMap(function(t){try{var r=n?new t(e,n):new t(e);return o.option(r)}catch(t){return o.none}})}return t.prototype.hash=function(){return this.url.flatMap(function(t){return o.option(t.hash)})},t.prototype.host=function(){return this.url.flatMap(function(t){return o.option(t.host)})},t.prototype.hostname=function(){return this.url.flatMap(function(t){return o.option(t.hostname)})},t.prototype.href=function(){return this.url.flatMap(function(t){return o.option(t.href)})},t.prototype.origin=function(){return this.url.flatMap(function(t){return o.option(t.origin)})},t.prototype.password=function(){return this.url.flatMap(function(t){return o.option(t.password)})},t.prototype.pathname=function(){return this.url.flatMap(function(t){return o.option(t.pathname)})},t.prototype.port=function(){return this.url.flatMap(function(t){return o.option(t.port)})},t.prototype.protocol=function(){return this.url.flatMap(function(t){return o.option(t.protocol)})},t.prototype.search=function(){return this.url.flatMap(function(t){return o.option(t.search)})},t.prototype.searchParams=function(){return this.url.flatMap(function(t){return o.option(t.searchParams)})},t.prototype.username=function(){return this.url.flatMap(function(t){return o.option(t.username)})},t}();e.URLWrapper=i},function(t,e,n){(function(e,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */
!function(e,n){t.exports=n()}(0,function(){"use strict";function t(t){return"function"==typeof t}var r=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=0,i=void 0,a=void 0,s=function(t,e){d[o]=t,d[o+1]=e,2===(o+=2)&&(a?a(g):v())};var u="undefined"!=typeof window?window:void 0,c=u||{},l=c.MutationObserver||c.WebKitMutationObserver,p="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var t=setTimeout;return function(){return t(g,1)}}var d=new Array(1e3);function g(){for(var t=0;t<o;t+=2){(0,d[t])(d[t+1]),d[t]=void 0,d[t+1]=void 0}o=0}var v=void 0;function m(t,e){var n=this,r=new this.constructor(E);void 0===r[b]&&k(r);var o=n._state;if(o){var i=arguments[o-1];s(function(){return D(o,r,i,n._result)})}else x(n,r,t,e);return r}function y(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(E);return P(e,t),e}v=p?function(){return e.nextTick(g)}:l?function(){var t=0,e=new l(g),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():f?function(){var t=new MessageChannel;return t.port1.onmessage=g,function(){return t.port2.postMessage(0)}}():void 0===u?function(){try{var t=Function("return this")().require("vertx");return void 0!==(i=t.runOnLoop||t.runOnContext)?function(){i(g)}:h()}catch(t){return h()}}():h();var b=Math.random().toString(36).substring(2);function E(){}var _=void 0,w=1,O=2;function T(e,n,r){n.constructor===e.constructor&&r===m&&n.constructor.resolve===y?function(t,e){e._state===w?I(t,e._result):e._state===O?S(t,e._result):x(e,void 0,function(e){return P(t,e)},function(e){return S(t,e)})}(e,n):void 0===r?I(e,n):t(r)?function(t,e,n){s(function(t){var r=!1,o=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(n,e,function(n){r||(r=!0,e!==n?P(t,n):I(t,n))},function(e){r||(r=!0,S(t,e))},t._label);!r&&o&&(r=!0,S(t,o))},t)}(e,n,r):I(e,n)}function P(t,e){if(t===e)S(t,new TypeError("You cannot resolve a promise with itself"));else if(function(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}(e)){var n=void 0;try{n=e.then}catch(e){return void S(t,e)}T(t,e,n)}else I(t,e)}function M(t){t._onerror&&t._onerror(t._result),C(t)}function I(t,e){t._state===_&&(t._result=e,t._state=w,0!==t._subscribers.length&&s(C,t))}function S(t,e){t._state===_&&(t._state=O,t._result=e,s(M,t))}function x(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+w]=n,o[i+O]=r,0===i&&t._state&&s(C,t)}function C(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,a=0;a<e.length;a+=3)r=e[a],o=e[a+n],r?D(n,r,o,i):o(i);t._subscribers.length=0}}function D(e,n,r,o){var i=t(r),a=void 0,s=void 0,u=!0;if(i){try{a=r(o)}catch(t){u=!1,s=t}if(n===a)return void S(n,new TypeError("A promises callback cannot return that same promise."))}else a=o;n._state!==_||(i&&u?P(n,a):!1===u?S(n,s):e===w?I(n,a):e===O&&S(n,a))}var R=0;function k(t){t[b]=R++,t._state=void 0,t._result=void 0,t._subscribers=[]}var U=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(E),this.promise[b]||k(this.promise),r(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?I(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&I(this.promise,this._result))):S(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===_&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===y){var o=void 0,i=void 0,a=!1;try{o=t.then}catch(t){a=!0,i=t}if(o===m&&t._state!==_)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===A){var s=new n(E);a?S(s,i):T(s,t,o),this._willSettleAt(s,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===_&&(this._remaining--,t===O?S(r,n):this._result[e]=n),0===this._remaining&&I(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;x(t,void 0,function(t){return n._settledAt(w,e,t)},function(t){return n._settledAt(O,e,t)})},t}();var A=function(){function e(t){this[b]=R++,this._result=this._state=void 0,this._subscribers=[],E!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e(function(e){P(t,e)},function(e){S(t,e)})}catch(e){S(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return t(e)?this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})}):this.then(e,e)},e}();return A.prototype.then=m,A.all=function(t){return new U(this,t).promise},A.race=function(t){var e=this;return r(t)?new e(function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}):new e(function(t,e){return e(new TypeError("You must pass an array to race."))})},A.resolve=y,A.reject=function(t){var e=new this(E);return S(e,t),e},A._setScheduler=function(t){a=t},A._setAsap=function(t){s=t},A._asap=s,A.polyfill=function(){var t=void 0;if(void 0!==n)t=n;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var r=null;try{r=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===r&&!e.cast)return}t.Promise=A},A.Promise=A,A})}).call(this,n(28),n(27))},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(1),i=n(10),a=n(9),s=n(3);e.QUERY_KEY="_adp_cd_id",e.DECORATOR="decorate";var u=["click","keydown","touchstart","touchend","contextmenu"];e.TIMEOUT_SEC=20;var c=function(){function t(t){this.global=t,this.eventTypes=u,this.crossDomainTargets=[],this.crossDomainExcludes=[],r.assertNotNull(t),this.w=t.window(),this.namespace=t.namespace.bind(t),this.timer=t.timer,this.doc=t.doc,this.util=new a.CrossDomainTrackingUtil(t),this.location=t.location}return Object.defineProperty(t.prototype,"isActivated",{get:function(){return!!this.namespace().cdtrIsActivated},set:function(t){this.namespace().cdtrIsActivated=t},enumerable:!0,configurable:!0}),t.prototype.activate=function(t,e){var n=this;this.isActivated||t.forEach(function(t){n.crossDomainTargets=r.filter(t,function(t){return""!==t}),n.crossDomainExcludes=r.filter(e.getOrElse([]),function(t){return""!==t}),n.crossDomainTargets.length>0&&(n.applySetEventListners(),n.applyReplaceMetaTagContents(),n.applySetDecoratorFunction(),n.isActivated=!0)})},t.prototype.applySetEventListners=function(){var t=this;r.each(this.eventTypes,function(e){t.doc.addEventListener(e,function(e){return t.decorateLinkUrl(e)},!1)})},t.prototype.applyReplaceMetaTagContents=function(){var t=this,e=this.doc.querySelectorAll('meta[http-equiv="refresh"]');if(e.isDefined()&&e.get().length>0){for(var n=[],r=0;r<e.get().length;r++)n.push(e.get()[r]);var o=this.timer.setInterval(function(){t.doc.cookie.existsUidOn1stPartyCookie()&&(t.replaceMetaTagContents(n),t.timer.clearInterval(o))},100);this.timer.setTimeout(function(){return t.timer.clearInterval(o)},5e3)}},t.prototype.applySetDecoratorFunction=function(){this.namespace()[e.DECORATOR]=this.createDecoratorFunction()},t.prototype.decorateLinkUrl=function(t){var e=this;if(t.target)if(t.target.form&&t.target.form.action){var n=t.target.form;this.getLinkUrl(n,"action").forEach(function(t){e.getDecoratedUrl(t,0).forEach(function(e){t!==e&&(n.action=e)})})}else{var r=function(t,e){return t[e]?o.some(t):t.parentElement?r(t.parentElement,e):o.none};r(t.target,"href").forEach(function(t){e.getLinkUrl(t,"href").forEach(function(n){e.getDecoratedUrl(n,0).forEach(function(e){n!==e&&(t.href=e)})})})}},t.prototype.getDecoratedUrl=function(t,e){var n=this;return this.complementProtocol(t).filter(function(t){return n.util.shouldDecorate(t,n.crossDomainTargets,n.crossDomainExcludes)}).flatMap(function(t){return n.appendCrossDomainId(t,e)})},t.prototype.complementProtocol=function(t){var e=this;return this.location.href().flatMap(function(n){return new s.URLWrapper(e.w,t,n).href()})},t.prototype.appendCrossDomainId=function(t,e){var n=this;return this.doc.cookie.getUid().flatMap(function(r){var o=n.util.generateIdentifier(),a=n.util.getTimestamp()+e;return i.CrossDomainId.from(n.w,r,o,""+a).generateCrossDomainTrackingUrl(t)})},t.prototype.parseMetaTagContent=function(t){var e=/^ *(\d+) *[;,] *(?:url *=)? *(['"]?)((https?:)?\/\/.*)\2/i.exec(t);if(e){e[0];var n=e[1],r=(e[2],e[3]);return n&&r?o.some({timeout:Number(n),url:r}):o.none}return o.none},t.prototype.replaceMetaTagContents=function(t){var e=this;r.each(t,function(t){var n=t.content;e.parseMetaTagContent(n).forEach(function(n){var r=n.timeout,o=n.url;e.getDecoratedUrl(o,r).forEach(function(e){o!==e&&(t.content=r+";URL="+e)})})})},t.prototype.createDecoratorFunction=function(){var t=this;return function(e){try{return"string"==typeof e&&e.length>0?t.getDecoratedUrl(e,0).getOrElse(e):e}catch(n){return t.global.logErrorThenCaptureException(n),e}}},t.prototype.getLinkUrl=function(t,e){if(!t[e]||!t.getAttribute)return o.none;var n=t.getAttribute(e)||"";return/^(https?:)?\/\//i.test(n)?o.option(t[e]):o.none},t}();e.CrossDomainTrackingRegister=c},function(t,e,n){(function(t){var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new r(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,n||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),s=n(26),u=n(11),c=n(1),l=n(13),p=n(25),f=n(24),h=n(23),d=n(22),g=n(21),v=n(2),m=n(14),y=n(0);e.TOP_LEVEL_DOMAIN="topLevelDomain",e.PREVENT_REPLACE_DOCUMENT_METHODS="_preventReplaceDocumentMethods";var b=function(){function t(t,e){if(this.ns=e,null==t)throw new u.PreConditionError("window is undefined");if(null==t.document)throw new u.PreConditionError("document is undefined");this.w=t,this.timer=new x(t),this.navigator=new S(t),this.location=new C(this,t.location),this.doc=new E(this,t.document),this.beacons=new w(this),this.res=new O(this),this.done=new T(this),this.jsonps=new P(this),this.callbacks=new M(this),this.eventPings=new I(this),this.raven=new g.RavenWrapper(this),this.receivedOrders=new D(this)}return Object.defineProperty(t.prototype,"isCrossDomainFeaturesApplied",{get:function(){return this.namespace()&&this.namespace().isCrossDomainFeaturesApplied},set:function(t){this.namespace()&&(this.namespace().isCrossDomainFeaturesApplied=t)},enumerable:!0,configurable:!0}),t.prototype.activate=function(){return this.namespace()instanceof Array||(this.w[this.ns]=[]),this.beacons.activate(),this.done.activate(),this.jsonps.activate(),this.callbacks.activate(),this.eventPings.activate(),this.raven.activate(),this.receivedOrders.activate(),this.crossDomainTrackingUidReader=new h.CrossDomainTrackingUidReader(this),this.crossDomainTrackingInitializer=new d.CrossDomainTrackingInitializer(this),this.applyCrossDomainFeatures(),this},t.prototype.receiveOrder=function(t){for(var e=this.namespace().length,n=0;n<e;n++){var r=this.namespace()[n];if(null!=r){var o=t(r);if(o.isDefined())return delete this.namespace()[n],o}}return c.none},Object.defineProperty(t.prototype,"localStorage",{get:function(){try{return c.option(this.w.localStorage)}catch(t){return c.none}},enumerable:!0,configurable:!0}),t.prototype.useTrackerResponse=function(){this.syncUid(),this.updateCid()},t.prototype.syncUid=function(){var t=this;this.isUidSynced()||this.res.uid().forEach(function(e){t.doc.cookie.isCookieEnabled()&&(t.res.use1stPartyCookie().exists(Boolean)&&t.setUidTo1stPartyCookie(e),t.res.useLocalStorage().exists(Boolean)&&t.setUidToLocalStorage(e)),t.namespace().synced=!0})},t.prototype.setUidTo1stPartyCookie=function(t){var e=this.res.expires();this.doc.cookie.putWithExpires("_adp_uid",t,e.getOrElse(1/0))},t.prototype.setUidToLocalStorage=function(t){this.doc.cookie.setToLocalStorage("_adp_uid",t)},t.prototype.updateCid=function(){var t=this;this.res.cid().forEach(function(e){t.res.accountId().forEach(function(n){if(t.doc.cookie.isCookieEnabled()){var r="_adp_cid_"+n;if(t.res.use1stPartyCookie().exists(Boolean)){var o=t.res.expires();t.doc.cookie.putWithExpires(r,e,o.getOrElse(1/0))}t.res.useLocalStorage().exists(Boolean)&&t.doc.cookie.setToLocalStorage(r,e)}})})},t.prototype.isUidSynced=function(){return c.option(this.namespace().synced).exists(function(t){return!0===t})},t.prototype.calcCid=function(t,e){return s.md5(t+","+e)},t.prototype.getCid=function(t,e){var n=this;return e.map(function(e){return n.calcCid(t,e)}).orElseLazy(function(){return n.doc.cookie.getCid(t)})},t.prototype.namespace=function(){return this.w[this.ns]},t.prototype.window=function(){return this.w},t.prototype.eval=function(t){return null!=this.w.execScript&&null==this.w.execScript.call?this.w.execScript(t):this.w.eval.call(this.w,t)},t.prototype.unisNamespace=function(){return this.w._pdbd},t.prototype.unisIdFromUnisNamespace=function(){var t=this,e=this.unisNamespace()?c.option(this.unisNamespace().unisId):c.none;return e.forEach(function(e){e.length>64&&t.logErrorThenCaptureException(new Error("too long unisId."),{unisId:e})}),e},t.prototype.debug=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];null!=console&&null!=console.debug&&this.isDebug()&&console.debug(t,e)},t.prototype.logErrorThenCaptureException=function(t,e){a.logError(t),this.raven.captureException(t,e)},t.prototype.isDebug=function(){return c.option(this.namespace().debug).exists(function(t){return!0===t})},t.prototype.cvAndCall=function(t,e){var n=this;void 0===e&&(e=function(){}),c.option(this.eventPings.get(t)).forEach(function(t){var r=new l.SingleBeacon(n,function(){n.done.add(t.order)},t.ping);n.doc.fire([c.some(r)],function(t){return v.setOnload(t,function(){n.syncUid(),n.updateCid(),e()})})})},t.prototype.cvAndMove=function(t,e){var n=this;this.cvAndCall(t,function(){return n.location.assign(c.some(e))}),setTimeout(function(){return n.location.assign(c.some(e))},1e3)},t.prototype.cvAndMoveIfPossible=function(t,e){e.isDefined()?this.cvAndMove(t,e.get()):this.cvAndCall(t)},t.prototype.cvOn=function(t,e,n){this.doc.addEventListener(t,this.createListener(e,n),!1)},t.prototype.createListener=function(t,e){var n=this;return function(r){v.getTarget(r).filter(v.isElement).flatMap(function(e){return v.closest(e,t)}).forEach(function(t){var o=v.closest(t,"a, area");o.exists(function(t){return"_blank"!==t.target})?(r.preventDefault(),n.cvAndMoveIfPossible(e,o.flatMap(function(t){return c.nonEmptyOption(t.href)}))):n.cvAndCall(e)})}},t.prototype.applyCrossDomainFeatures=function(){var t=this;this.isCrossDomainFeaturesApplied||(this.crossDomainTrackingUidReader.getUid().forEach(function(e){t.setUidTo1stPartyCookie(e)}),this.crossDomainTrackingInitializer.setInitialDecoratorFunction(),this.isCrossDomainFeaturesApplied=!0)},t}();e.Global=b;var E=function(){function e(t,e){this.global=t,this.d=e,a.assertNotNull(t,e),this.cookie=new _(t,e)}return e.prototype.fire=function(e,n){return o(this,void 0,t,function(){var r,o=this;return i(this,function(i){switch(i.label){case 0:return r=function(t){return o.loadScriptAsync(t,n)},[4,t.all(a.map(e,function(e){return e.map(function(t){return t.run(r)}).getOrElse(t.resolve())}))];case 1:return i.sent(),[2]}})})},e.prototype.loadScriptAsync=function(e,n){return o(this,void 0,t,function(){var r,o,a=this;return i(this,function(i){switch(i.label){case 0:return(r=this.d.createElement("script")).type="text/javascript",r.async=!0,r.charset="UTF-8",(o=this.d.getElementsByTagName("script")[0]).parentNode?o.parentNode.insertBefore(r,o):this.d.appendChild(r),c.option(n).forEach(function(t){return t(r)}),[4,new t(function(t){var n=function(){r.removeEventListener("load",n),r.removeEventListener("error",n),t()};r.addEventListener("load",n),r.addEventListener("error",n),r.src=e,a.global.debug("DocumentWrapper#loadScriptAsync("+e+")")})];case 1:return i.sent(),[2]}})})},e.prototype.appendChild=function(t,e){var n=document.createElement(t);c.option(e).forEach(function(t){return t(n)}),this.d.body.appendChild(n)},e.prototype.getElementById=function(t){return this.d.getElementById(t)},e.prototype.querySelectorAll=function(t){return this.d.querySelectorAll?c.some(this.d.querySelectorAll(t)):c.none},e.prototype.title=function(){return c.nonEmptyOption(this.d.title)},e.prototype.referrerUrl=function(){return c.nonEmptyOption(this.d.referrer)},e.prototype.get=function(t){return this.d[t]},e.prototype.set=function(t,e){this.d[t]=e},e.prototype.addEventListener=function(t,e,n){void 0===n&&(n=!1),this.d.addEventListener?this.d.addEventListener(t,e,n):this.d.attachEvent&&this.d.attachEvent("on"+t,e)},e.prototype.removeEventListener=function(t,e,n){void 0===n&&(n=!1),this.d.removeEventListener?this.d.removeEventListener(t,e,n):this.d.detachEvent&&this.d.detachEvent("on"+t,e)},Object.defineProperty(e.prototype,"hidden",{get:function(){return!!this.d.hidden},enumerable:!0,configurable:!0}),e}();e.DocumentWrapper=E;var _=function(){function t(t,e){this.global=t,this.document=e,a.assertNotNull(t,e),this.namespace=t.namespace.bind(t),this.location=function(){return t.location}}return t.prototype.isCookieEnabled=function(){var t=this.global.window();if("cookieEnabled"in t.navigator)return t.navigator.cookieEnabled;try{var e="_adp_check";this.putCookie(e,"1",!1,1/0,"","");var n=/(?:^|;)\s*_adp_check\s*=\s*1\s*(?:;|$)/.test(this.document.cookie);return this.putCookie(e,"",!1,0,"",""),n}catch(t){return!1}},t.prototype.getUid=function(){return this.get("_adp_uid")},t.prototype.getCid=function(t){return this.get("_adp_cid_"+t)},t.prototype.unisIdCacheCookieName=function(t){return"_unis_id_cache_"+t},t.prototype.getUnisIdCache=function(t){return this.get(this.unisIdCacheCookieName(t))},t.prototype.get=function(t){if(a.assertNotNull(t),!this.contains(t))return c.none;var e=this.document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+this.encode(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1");return e?c.some(this.decode(e)):this.getFromLocalStorage(t)},t.prototype.getFromLocalStorage=function(t){return this.global.localStorage.flatMap(function(e){return c.option(e.getItem(t))})},t.prototype.setToLocalStorage=function(t,e){this.global.localStorage.forEach(function(n){return n.setItem(t,e)})},t.prototype.contains=function(t){return new RegExp("(?:^|;\\s*)"+this.encode(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(this.document.cookie)||this.getFromLocalStorage(t).isDefined()},t.prototype.putWithExpires=function(t,e,n){this.put(t,e,!1,n,"/")},t.prototype.putUnisIdCache=function(t,e,n){this.put(this.unisIdCacheCookieName(t),e,!1,n,"/")},t.prototype.put=function(t,e,n,r,o){if(a.assertNotNull(t,e,n),!this.isInvalidKey(t)){var i=this.location().getTopLevelDomain().getOrElse("");this.cleanUpCookieByKey(t,n,o),this.putCookie(t,e,n,r,o,i)}},t.prototype.existsUidOn1stPartyCookie=function(){return this.getUid().exists(function(t){return!!t})},t.prototype.isInvalidKey=function(t){return/^(?:expires|max\-age|path|domain|secure)$/i.test(t)},t.prototype.putCookie=function(t,e,n,r,o,i){var a=this.encode(t)+"="+this.encode(e)+this.expires(r).getOrElse("")+(i?"; domain="+this.encode(i):"")+(o?"; path="+o:"")+(n?"; secure":"");this.document.cookie=a},t.prototype.cleanUpCookieByKey=function(t,e,n){var r=this;this.location().hostname().forEach(function(o){for(var i=o.split("."),a=i.length-1;a>=0;--a){var s=i.slice(a).join("."),u=a>0?"."+s:s;r.putCookie(t,"",e,0,n,u)}r.putCookie(t,"",e,0,n,"")})},t.prototype.expires=function(t){return void 0===t&&(t=1/0),c.option(t).map(function(e){if("number"==typeof e)return e===1/0?"; expires=Tue, 19 Jan 2038 03:14:07 UTC":"; max-age="+e;if("string"==typeof e)return"; expires="+e;if(e instanceof Date)return"; expires="+e.toUTCString();throw new TypeError("number/string/Date以外はだめ value: "+t)})},t.prototype.encode=function(t){return encodeURIComponent(t)},t.prototype.decode=function(t){return a.decodeURIComponentOrNot(t)},t}();e.CookieWrapper=_;var w=function(){function t(t){this.global=t,a.assertNotNull(t)}return t.prototype.activate=function(){null==this.global.namespace()._q?(this.global.debug("BeaconQueueWrapper#activate: new"),this.global.namespace()._q=new p.BeaconQueue(this.global)):this.global.debug("BeaconQueueWrapper#activate: "+this.global.namespace()._q.constructor),this.beaconQueue=this.global.namespace()._q},t.prototype.add=function(t){this.beaconQueue.queue(t)},t.prototype.launch=function(){this.beaconQueue.run()},t.prototype.toDebugObject=function(){return this.beaconQueue.getBeacons()},t}(),O=function(){function t(t){this.global=t,a.assertNotNull(t)}return t.prototype.uid=function(){return this.res().flatMap(function(t){return c.nonEmptyOption(String(t.uid))})},t.prototype.cid=function(){return this.res().flatMap(function(t){return c.nonEmptyOption(t.cid)})},t.prototype.accountId=function(){return this.res().flatMap(function(t){return c.nonEmptyOption(String(t.accountId))})},t.prototype.use1stPartyCookie=function(){return this.res().flatMap(function(t){return c.nonEmptyOption(t.use1st)})},t.prototype.useLocalStorage=function(){return this.res().flatMap(function(t){return c.nonEmptyOption(t.useLocalStorage)})},t.prototype.expires=function(){return this.res().flatMap(function(t){return c.nonEmptyOption(String(t.expires))})},t.prototype.webSiteResponse=function(){return this.res().flatMap(function(t){var e=t.eventId,n=t.siteEventConfig;return"string"==typeof e&&y.isArray(n)?c.some({eventId:e,siteEventConfig:a.filterDefined(a.map(n,m.bindSiteEventConfig))}):c.none})},t.prototype.res=function(){return this.global.namespace()?c.option(this.global.namespace().res):c.none},t.prototype.toDebugObject=function(){var t=this;return this.res().map(function(){return{uid:t.uid().getOrElse(null),use1st:t.use1stPartyCookie().getOrElse(null),useLocalStorage:t.useLocalStorage().getOrElse(null),expires:t.expires().getOrElse(null)}}).getOrElse(null)},t}();e.TrackerResponseWrapper=O;var T=function(){function t(t){this.global=t,this.namespace="_done",a.assertNotNull(t)}return t.prototype.activate=function(){this.global.namespace()[this.namespace]instanceof Array||(this.global.namespace()[this.namespace]=[])},t.prototype.add=function(t){this.global.namespace()[this.namespace]instanceof Array||this.activate(),this.global.namespace()[this.namespace].push(t)},t.prototype.toDebugObject=function(){return this.global.namespace()[this.namespace]||null},t}(),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.namespace="_jsonp",e}return r(e,t),e}(f.ObjectPool),M=function(t){function e(e,n){void 0===n&&(n=function(){return Math.random()});var r=t.call(this,e)||this;return r.global=e,r.random=n,r.namespace="_gcb",r}return r(e,t),e.prototype.publishId=function(){return"adpv7_gcb_"+(new Date).getTime()+"_"+Math.round(1e8*this.random())},e}(f.ObjectPool),I=function(t){function e(e){var n=t.call(this,e)||this;return n.global=e,n.namespace="_evCvs",n}return r(e,t),e.prototype.get=function(t){return this.global.namespace()[this.namespace][t]},e.prototype.toDebugObject=function(){return this.global.namespace()[this.namespace]||null},e}(f.ObjectPool),S=function(){function t(t){a.assertNotNull(t),this.navigator=c.option(t.navigator)}return t.prototype.vendor=function(){return this.navigator.flatMap(function(t){return c.option(t.vendor)})},t.prototype.userAgent=function(){return this.navigator.flatMap(function(t){return c.option(t.userAgent)})},t.prototype.sendBeacon=function(t){return this.navigator.exists(function(e){return"function"==typeof e.sendBeacon&&e.sendBeacon(t)})},t}();e.NavigatorWrapper=S;var x=function(){function t(t){a.assertNotNull(t),this.w=t}return t.prototype.setTimeout=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return this.w.setTimeout(t,e,n)},t.prototype.clearTimeout=function(t){this.w.clearTimeout(t)},t.prototype.setInterval=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return this.w.setInterval(t,e,n)},t.prototype.clearInterval=function(t){this.w.clearInterval(t)},t}();e.TimerWrapper=x;var C=function(){function t(t,e){a.assertNotNull(t),this.namespace=t.namespace.bind(t),this.location=c.option(e),this.cookie=function(){return t.doc.cookie}}return t.prototype.href=function(){return this.location.flatMap(function(t){return c.nonEmptyOption(t.href)})},t.prototype.search=function(){return this.location.flatMap(function(t){return c.nonEmptyOption(t.search)})},t.prototype.assign=function(t){this.location.forEach(function(e){return t.forEach(function(t){return e.assign(t)})})},t.prototype.hostname=function(){return this.location.flatMap(function(t){return c.nonEmptyOption(t.hostname)})},t.prototype.getTopLevelDomain=function(){var t=this;return this.namespace()[e.TOP_LEVEL_DOMAIN]||this.putDummyCookieForDetectTopLevelDomain(this.hostname()).forEach(function(n){t.namespace()[e.TOP_LEVEL_DOMAIN]=n}),c.nonEmptyOption(this.namespace()[e.TOP_LEVEL_DOMAIN])},t.prototype.putDummyCookieForDetectTopLevelDomain=function(t){var e=this;return t.map(function(t){var n,r=t.split("."),o=r.length;do{n="__"+a.getRandomString(4)}while(e.cookie().get(n).exists(function(t){return!!t}));for(var i=a.getRandomString(4),s=o-1;s>=0;--s){var u=r.slice(s).join("."),c=s>0?"."+u:u;if(e.cookie().putCookie(n,i,!1,1,"/",c),e.cookie().get(n).exists(function(t){return t===i}))return e.cookie().putCookie(n,"",!1,0,"/",c),c.replace(/^\./,"")}return t})},t}();e.LocationWrapper=C;var D=function(){function t(t){this.global=t,this.namespace="_order",a.assertNotNull(t)}return t.prototype.activate=function(){this.global.namespace()[this.namespace]instanceof Array||(this.global.namespace()[this.namespace]=[])},t.prototype.add=function(t){this.global.namespace()[this.namespace]instanceof Array||this.activate(),this.global.namespace()[this.namespace].push(t)},t.prototype.toDebugObject=function(){return this.global.namespace()[this.namespace]||null},t}()}).call(this,n(4))},function(t,e,n){(function(t){var r=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new r(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,n||[])).next())})},o=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=function(){function e(t,e,n){this.trackerUrl=t,this.preprocess=e,this.wrapper=n}return e.prototype.run=function(e){return r(this,void 0,t,function(){return o(this,function(t){return null==this.preprocess||!0===this.preprocess()?[2,e(this.trackerUrl.build((new Date).getTime()))]:[2]})})},e.prototype.makeWrappedRunNext=function(t){return null==this.wrapper?t:this.wrapper.wrapRunNext(t)},e.prototype.toString=function(){return i.makeJsonString({trackerUrl:this.trackerUrl.toString(),preprocess:this.preprocess?this.preprocess.toString():"null",wrapper:this.wrapper?"SequentialPingWrapper":"null"})},e}();e.Ping=a}).call(this,n(4))},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(1),i=function(){function t(t,e){this.baseUrl=t,this.params=e}return t.prototype.build=function(t){return this.baseUrl+"?"+function(t){r.assertNotNull(t);var e=[];return r.eachProp(t,function(t,n){if(n instanceof Array)for(var r=0,i=n;r<i.length;r++){var a=i[r];e.push(encodeURIComponent(t)+"="+encodeURIComponent(o.option(a).getOrElse("")))}else e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}),e.join("&")}(r.extend(this.params(),function(t){return o.nonEmptyOption(String(t)).map(function(t){return{_cb:t}}).getOrElse({})}(t)))},t}();e.MessageBuilder=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(3),i=["pdf","zip","exe","txt","gif","jpg","jpeg","png","mp3","mp4","m4a","swf","wvx","wmv","doc","docx","docm","xls","xlsx","xlsm","ppt","pptx","pptm","ppsx","ppsm"],a=function(){function t(t){r.assertNotNull(t),this.w=t.window(),this.res=t.res,this.location=t.location,this.navigator=t.navigator}return t.prototype.existsUrlClass=function(){var t=this;return this.location.href().exists(function(e){return new o.URLWrapper(t.w,e).href().exists(function(t){return!!t})})},t.prototype.isSameTopLevelDomain=function(t){var e=this;return this.location.getTopLevelDomain().exists(function(n){return new o.URLWrapper(e.w,t).hostname().exists(function(t){var r="."+t,o=new RegExp(e.escapeUrlForRegex("."+n)+"$");return!!r.match(o)})})},t.prototype.getTimestamp=function(){return Math.round(Date.now()/1e3)},t.prototype.generateIdentifier=function(){return this.navigator.vendor().map(function(t){return new RegExp("apple","i").test(t)?"1":"0"}).getOrElse("0")},t.prototype.use1stPartyCookie=function(){return this.res.use1stPartyCookie().getOrElse(!0)},t.prototype.isCrossDomainTarget=function(t,e){var n=this;return r.find(t,function(t){return n.contains(e,t)}).isDefined()},t.prototype.isExcludedURL=function(t,e){var n=this;return r.find(t,function(t){return n.contains(e,t)}).isDefined()},t.prototype.hasExcludedExtension=function(t){var e=this;return r.find(i,function(n){return new RegExp(e.escapeUrlForRegex("."+n)+"($|\\?|#)","i").test(t)}).isDefined()},t.prototype.shouldDecorate=function(t,e,n){return this.existsUrlClass()&&this.use1stPartyCookie()&&!this.isSameTopLevelDomain(t)&&this.isCrossDomainTarget(e,t)&&!this.isExcludedURL(n,t)&&!this.hasExcludedExtension(t)},t.prototype.contains=function(t,e){var n=this;return this.location.href().exists(function(r){var i=new o.URLWrapper(n.w,t,r);return i.origin().exists(function(t){return i.pathname().exists(function(r){var o=t+r;return new RegExp(n.escapeUrlForRegex(e),"i").test(o)})})})},t.prototype.escapeUrlForRegex=function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},t}();e.CrossDomainTrackingUtil=a},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r,o=n(0),i=n(1),a=n(5),s=n(3);!function(t){t[t.uid=0]="uid",t[t.identifier=1]="identifier",t[t.timestamp=2]="timestamp"}(r||(r={})),e.DEBOUNCE_SEC=3;var u=function(){function t(t,e,n,r){this.uid=e,this.identifier=n,this.timestamp=r,this.w=t}return t.parse=function(e,n){o.assertNotNull(e);var r=n.split("."),a=r[0],s=r[1],u=void 0===s?"":s,c=r[2],l=void 0===c?"0":c;return a.length>0&&u.length>0&&Number(l)>0?i.some(new t(e,a,u,l)):i.none},t.from=function(e,n,r,i){return o.assertNotNull(e),new t(e,n,r,i)},t.prototype.shouldUpdate=function(t,e){return this.identifier===t&&Number(this.timestamp)<=e&&e<Number(this.timestamp)+a.TIMEOUT_SEC},t.prototype.getUid=function(){return this.uid},t.prototype.generateCrossDomainTrackingUrl=function(t){var e=this,n=new s.URLWrapper(this.w,t),r=this.createCrossDomainId();return n.searchParams().map(function(t){return!(t.getAll(a.QUERY_KEY).length>1)&&(!(t.has(a.QUERY_KEY)&&!e.isValid(t.get(a.QUERY_KEY)))&&(!!e.isValid(r)&&(!(t.has(a.QUERY_KEY)&&e.isValid(t.get(a.QUERY_KEY))&&e.suppressUpdate(e.timestamp,t.get(a.QUERY_KEY)))&&(t.set(a.QUERY_KEY,r),!0))))}).flatMap(function(t){return t?n.href():i.none})},t.prototype.createCrossDomainId=function(){return this.uid+"."+this.identifier+"."+this.timestamp},t.prototype.isValid=function(t){return/^.+\..+\.[0-9]+$/.test(t||"")},t.prototype.pick=function(t,e){if(!this.isValid(t))return"";var n=/^ *(.+) *(\.) *(.+) *(\.) *([0-9]+)$/.exec(t);if(!n)return"";n[0];var o=n[1],i=(n[2],n[3]),a=(n[4],n[5]);return e===r.identifier?i:e===r.timestamp?a:o},t.prototype.suppressUpdate=function(t,n){var o=this.pick(n,r.timestamp);return Number(t)-Number(o)<e.DEBOUNCE_SEC},t}();e.CrossDomainId=u},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t){this.message=t,this.name="PreConditionError"}}();e.PreConditionError=n;var r=function(){return function(t){this.message=t,this.name="IllegalOrderError"}}();e.IllegalOrderError=r},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=function(){function t(t,e,n,r,o,i,a,s,u,c){this.uid1stParty=t,this.cid1stParty=e,this.segments=n,this.unisId=r,this.idfa=o,this.advertisingId=i,this.title=a,this.locationUrl=s,this.referrerUrl=u,this.finalUrl=c}return t.prototype.toJson=function(){return r.slim({u1:this.uid1stParty,cid1:this.cid1stParty,"sg[]":this.segments,un:this.unisId,idfa:this.idfa,adv:this.advertisingId,t:this.title,l:this.locationUrl,r:this.referrerUrl,f:this.finalUrl})},t}();e.WebReport=o},function(t,e,n){(function(t){var n=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new r(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,n||[])).next())})},r=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function e(t,e,n){this.global=t,this.callback=e,this.first=n}return e.prototype.run=function(e){return n(this,void 0,t,function(){var t;return r(this,function(n){return t=this.first.run(e),this.callback&&this.callback(),[2,t]})})},e}();e.SingleBeacon=o}).call(this,n(4))},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);function o(t){return RegExp("^"+t.replace(/[-/\\^$+?.()|[\]{}]/g,"\\$&").replace(/\*(\*)*/g,function(t,e){return e?".*":"[^/]*"})+"$")}e.bindSiteEventConfig=function(t){var e=t||{},n=e.name,o=e.clickSelector,i=e.readingSelector,a=e.readingMaxDuration,s=e.status,u=e.pattern;return r.isString(n)&&r.isArray(u)&&r.every(u,r.isString)&&r.isNumber(s)&&(void 0===o||r.isString(o))&&(void 0===i||r.isString(i))&&(void 0===a||r.isNumber(a))?{name:n,pattern:r.filterDefined(u),clickSelector:o,readingSelector:i,readingMaxDuration:a,status:s}:null},e.patternToRegExp=o,e.isActiveConfig=function(t,e){return 1===t.status&&e.exists(function(e){return r.exists(t.pattern,function(t){return o(t).test(e)})})}},function(t,e,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),i=n(31),a=["b98f4519807df984be7d16a030701a37cc8069bcc8456299b6a7922312c89675","93f495353faa9ed5c1907bedfe5e178bbc12aef7136c9020566952ef290d02cd","09da2e330f6229583c04a5c6576d110a9b65a1b203d739640eb6258656692399"];e.tHashes=a;var s=["ab043a999abc1215c4d3477b7c7262f136df0bc878c15b208a3ab94baafe365a","27a82527b48505aa47bcd71a53325984685bcdf55e4fc773dba6cae3dd6971ff"];e.gHashes=s;e.mHashes=["f6b77a6b3f9a0fb2ce71106ca1fed50db384440b90010bd60e2fb93c75504a27"];var u=["df01fc0d51cdccef05892d97c1013ad05404023a1edd2b2be7d177992b0a0da1","6d0f8d6452bbeb21284a6b2535dd3d7d2252a8125a98f3647ecde02c30ff60f8","f1e1ae137b96f41281145e0a98b9f13cc66a2ca26a6e02532c2c526c82a55ddf","511ff301529c197f2133b1030331b55d7acd9a4b76a1c26ef661239311a34466","2ffd6323a019c2baf0214befaac4222fabc82e16f072992ee65bb6b614bcda3b","01946a5588841636147ec25e9cb91a662d9473ff809f47bb33f75c934edc47b4","3bb3feb542dd0e7ea59026ba3f0933585505edbf9abb8068e5f13441c5812ecb","a0ff3a1b1f99674a94e7b587e2d2bdac9cc166ad9ebec6a1b96b3d7b561e727e","713baa13686fac0f979668358fb5f3de8a2d8b0cf7edbbca2e5d02a1221d3ff7","076cff2fca9f19bdb243b08d418257479b26ec20bd07c0a2b43c7d241f5debe6","3e047d17720c1b183cd4c9c7d4b998250f4da5defcec2619e0113b47dc1d01dc","d7faaeb0c4e4eeb09bcc0aad1b0ffccefba153017ca89c6cfceb6e70e8f26f21"];e.fHashes=u;var c=["5b746332de59e77ad75544cc61e220d715f3418c46a40915d3078ccb4344c785"];e.sdHashes=c;var l=["e7dd24c24927975d18d25146a8c619ac39616fe3e4a988fa18aaf3f7724ad74d"];e.nHashes=l;var p=["f8e3579ae0051faa369ab0ccaacab436a1409e7d1b29e12ba37c1a51df5fc380","c5a0e31e5ef9e4b3c6f42c9231f27e24a0d664be1e0aac2944e4b1501ec456f9"];e.spHashes=p;var f=function(){function t(){}return t.prototype.fillDataBridgeEndPointUrl=function(t){var e=t.dataBridgeEndPointUrl,n=t.directMeasurementRootUrl,i=t.accountId;return r({},t,{dataBridgeEndPointUrl:o.nonEmptyOption(e).getOrElse(this.createDataBridgeEndPointUrl(n,i))})},t.prototype.createDataBridgeEndPointUrl=function(t,e){return t&&e?t+"db/pb/"+e:""},t.prototype.shouldFireDataBridgePing=function(t,e){var n=a.concat(s,u,c,l,p);return this.matchTopLevelDomainOrHostnameInDomainHashes(t,e,n)},t.prototype.shouldPreventReplaceDocumentMethods=function(t,e){var n=a.concat(s);return this.matchTopLevelDomainOrHostnameInDomainHashes(t,e,n)},t.prototype.matchTopLevelDomainOrHostnameInDomainHashes=function(t,e,n){return n.indexOf(i.sha256(t))>-1||n.indexOf(i.sha256(e))>-1},t}();e.DataBridgeHelper=f},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t,e,n,r,o,i,a,s,u,c,l,p){this.accountId=t,this.dataBridgeEndPointUrl=e,this.crossDomainTargets=n,this.crossDomainExcludes=r,this.emailOrUserIdForMatching=o,this.segments=i,this.unisId=a,this.idfa=s,this.advertisingId=u,this.title=c,this.locationUrl=l,this.referrerUrl=p}}();e.DataBridgeOrder=n},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(1),i=function(){function t(t){this.global=t,this.namespace="_atd",r.assertNotNull(t)}return t.activate=function(e){var n=new t(e);return n.activate(),n},t.prototype.activate=function(){null==this.global.namespace()[this.namespace]&&(this.global.namespace()[this.namespace]={})},t.prototype.scriptExecuted=function(t){return null==this.global.namespace()[this.namespace]&&this.activate(),o.option(this.global.namespace()[this.namespace][t]).exists(function(t){return!0===t})},t.prototype.pathname=function(t){return"window."+this.global.ns+"."+this.namespace+"."+t},t}();e.FiredFlags=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o="AlternativeDocument",i=function(){function t(t,e){this.global=t,this.execute=e,this.opened=!1,this.stack=[]}return t.prototype.open=function(){this.global.debug(o+"#open"),this.opened=!0,this.stack=[]},t.prototype.write=function(t){if(this.global.debug(o+"#write"),this.stack.push(t),!this.opened){var e=this.stack.join("");this.isValidAsHtmlTag(e)&&(this.execute(e),this.stack=[])}},t.prototype.writeln=function(t){this.global.debug(o+"#writeln"),this.write(t+"\n")},t.prototype.close=function(){this.global.debug(o+"#close"),this.execute(this.stack.join("")),this.opened=!1,this.stack=[]},t.prototype.isValidAsHtmlTag=function(t){try{var e=(new window.DOMParser).parseFromString(t,"text/html");return this.existsElementNode(e.head.childNodes)||this.existsElementNode(e.body.childNodes)}catch(e){return/<(br|basefont|hr|input|source|frame|param|area|meta|!--|col|link|option|base|img|wbr|!DOCTYPE).*?>|<(a|abbr|acronym|address|applet|article|aside|audio|b|bdi|bdo|big|blockquote|body|button|canvas|caption|center|cite|code|colgroup|command|datalist|dd|del|details|dfn|dialog|dir|div|dl|dt|em|embed|fieldset|figcaption|figure|font|footer|form|frameset|head|header|hgroup|h1|h2|h3|h4|h5|h6|html|i|iframe|ins|kbd|keygen|label|legend|li|map|mark|menu|meter|nav|noframes|noscript|object|ol|optgroup|output|p|pre|progress|q|rp|rt|ruby|s|samp|script|section|select|small|span|strike|strong|style|sub|summary|sup|table|tbody|td|textarea|tfoot|th|thead|time|title|tr|track|tt|u|ul|var|video).*?<\/\2>/i.test(t)}},t.prototype.existsElementNode=function(t){return r.exists(t,function(t){return 1===t.nodeType})},t}();e.AlternativeDocument=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(1),i=n(2),a=function(){function t(t,e){this.global=t,this.doByScriptElem=e,this.scripts=[]}return t.prototype.eval=function(t){var e=this,n=this.global.doc.getElementById(t);if(n){for(var r=n.getElementsByTagName("script"),o=0,i=r.length;o<i;o++){var a=r[o];a&&this.convert(a).forEach(function(t){return e.scripts.push(t)})}this.runScriptsSequential()}},t.prototype.convert=function(t){return o.nonEmptyOption(t.src).map(function(t){return{src:t}}).orElse(o.nonEmptyOption(t.innerHTML).map(function(t){return{inline:t}}))},t.prototype.runScriptsSequential=function(){var t=this;o.option(this.scripts.shift()).forEach(function(e){o.option(e.inline).forEach(function(e){return t.executeInlineScript(e)}),o.option(e.src).forEach(function(e){return t.executeScriptElement(e)})})},t.prototype.executeInlineScript=function(t){var e=this;try{t=this.sanitizeScriptString(t),this.doByScriptElem(),this.global.eval(t),this.global.debug("/** v7: [info] ScriptEvaluator#executeInlineScript */\n"+t)}catch(e){r.logError(e),this.global.debug("/** v7: [ERROR] ScriptEvaluator#executeInlineScript */\n"+t)}this.global.timer.setTimeout(function(){return e.runScriptsSequential()},100)},t.prototype.executeScriptElement=function(t){var e=this,n=function(){!1===n._fired&&(n._fired=!0,e.runScriptsSequential())};n._fired=!1,this.doByScriptElem(),this.global.doc.loadScriptAsync(t,function(t){return i.setOnload(t,n)}),this.global.debug("/** v7: [info] ScriptEvaluator#executeScriptElement */\n"+t)},t.prototype.sanitizeScriptString=function(t){for(var e=[],n=0,r=(t=t.replace(/\r/g,"")).split("\n");n<r.length;n++){var o=r[n];""!==o.replace(/\s+/,"")&&e.push(o)}return e.join("\n").replace(/^<!--/,"").replace(/-->$/,"")},t}();e.ScriptEvaluator=a},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(6),i=n(19),a=n(18),s=n(17),u=n(1),c=function(){function t(t,e){var n=this;this.global=t,this.random=e,this.documentMethodsOverwritten=!1,this.scriptEvaluator=new i.ScriptEvaluator(this.global,function(){return n.replaceDocumentMethods()}),this.alternativeDocument=new a.AlternativeDocument(this.global,function(t){return n.execute(t)}),this.global.jsonps.activate(),this.navigator=t.navigator,this.flags=s.FiredFlags.activate(this.global)}return t.allocate=function(e,n,r,o){return void 0===o&&(o=function(){return Math.random()}),new t(e,o).allocate(n,r)},t.prototype.allocate=function(t,e){var n=function(t){return"adpv7_cb4at_"+(new Date).getTime()+"_"+Math.round(1e8*t())}(this.random),r=this.buildTagExecutor(n,t,e);return this.global.jsonps.put(n,r),n},t.prototype.buildTagExecutor=function(t,e,n){var o=this;return function(i){var a=r.decodeURIComponentOpt(i);u.nonEmptyOption(a.getOrElse("")).isEmpty()?n():(e(a.getOrElse(""))||n(),a.forEach(function(t){o.replaceDocumentMethods(),o.execute(t)})),o.global.jsonps.remove(t)}},t.prototype.replaceDocumentMethods=function(){var t=this;this.global.namespace()[o.PREVENT_REPLACE_DOCUMENT_METHODS]||(this.documentMethodsOverwritten||(this.global.doc.set("__open",this.global.doc.get("open")),this.global.doc.set("__write",this.global.doc.get("write")),this.global.doc.set("__writeln",this.global.doc.get("writeln")),this.global.doc.set("__close",this.global.doc.get("close")),this.documentMethodsOverwritten=!0),this.global.doc.set("open",function(){return t.alternativeDocument.open()}),this.global.doc.set("write",function(e){return t.alternativeDocument.write(e)}),this.global.doc.set("writeln",function(e){return t.alternativeDocument.writeln(e)}),this.global.doc.set("close",function(){return t.alternativeDocument.close()}))},t.prototype.execute=function(t){var e=this;this.global.debug("AdditionalTag.execute("+t+")"),this.insertTag(function(t){return"adpv7_at_"+Math.round(1e8*t())}(this.random),t,function(t){return e.scriptEvaluator.eval(t)})},t.prototype.insertTag=function(t,e,n){var r=this;this.global.doc.appendChild("span",function(n){n.id=t;var o=["border:none !important;","background:transparent !important;","margin:0px !important;","padding:0px !important;"],i=r.isOldIE()?o.concat(["display:inline !important;"]):o.concat(["display:none !important;"]);n.setAttribute("style",i.join(" "));var a=r.isOldIE()?'<span style="position:absolute !important;top:-9999px !important;left:-9999px !important;">dummy</span>':"",s="<script type='text/javascript'>"+r.flags.pathname(t)+"=true;<\/script>";n.innerHTML=""+a+s+e}),this.global.debug("\x3c!-- v7: [info] AdditionalTag#insertTag --\x3e\n"+e),this.global.timer.setTimeout(function(){!1===r.flags.scriptExecuted(t)&&n(t)},0)},t.prototype.isOldIE=function(){return this.navigator.userAgent().exists(function(t){return/MSIE [1-8]\./.test(t)})},t}();e.AdditionalTag=c},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(1);e.SENTRY_DSN="https://2e16ae0a6123484ab78cbb7698f1dd55@sentry.io/272206",e.RAVEN_VERSION="3.22.1";var i="https://cdn.ravenjs.com/"+e.RAVEN_VERSION+"/raven.min.js";e.CAPTURE_EXCEPTION="captureException",e.SENT_TO_SENTRY="_sentToSentry";var a=function(){function t(t){this.global=t,this.isRavenRequested=!1,this.myRaven=null,r.assertNotNull(t),this.w=t.window()}return t.prototype.activate=function(){var t=this;this.global.namespace()[e.CAPTURE_EXCEPTION]||(this.global.namespace()[e.CAPTURE_EXCEPTION]=function(e,n){t.captureException(e,n)})},t.prototype.captureException=function(t,n){var r=this;if(!this.global.isDebug()){this.loadRaven(function(o){if(o)r.global.debug("RavenWrapper#captureException => callback:",o.message||o);else if(r.myRaven)if(t)try{r.myRaven.config(e.SENTRY_DSN).clearContext().setTagsContext({accountId:r.getAccountIdsStr().getOrElse(null),topLevelDomain:r.global.location.getTopLevelDomain().getOrElse(null),hostname:r.global.location.hostname().getOrElse(null),uid:r.global.res.uid().orElse(r.global.doc.cookie.getUid()).getOrElse(null)}).setExtraContext({global:{res:r.global.res.toDebugObject(),beacons:r.global.beacons.toDebugObject(),done:r.global.done.toDebugObject(),eventPings:r.global.eventPings.toDebugObject(),orders:r.global.receivedOrders.toDebugObject()},cookie:{uid:r.global.doc.cookie.getUid().getOrElse(null),all:r.w.document.cookie},extra:n}).install().captureException(t).uninstall(),r.pushSentHistory(t,n)}catch(t){return void r.global.debug("RavenWrapper#captureException => try block in callback:",t.message||t)}else r.global.debug("RavenWrapper#captureException => callback: error object must be defined.");else r.global.debug("RavenWrapper#captureException => callback: myRaven is not defined yet.")})}},t.prototype.loadRaven=function(t){if(this.w.Raven&&!this.myRaven)return t(new Error("Raven is already loaded by other apps."));if(this.myRaven||this.isRavenRequested)return t(null);var e=this.onloadFactory(t),n=t;this.requestRavenSrc(e,n),this.isRavenRequested=!0},t.prototype.onloadFactory=function(t){var n=this;return function(){n.w.Raven&&!n.w.Raven.isSetup()&&n.w.Raven.VERSION===e.RAVEN_VERSION?(n.myRaven=n.w.Raven,delete n.w.Raven,t(null)):t(new Error("Raven is already setup by other apps."))}},t.prototype.requestRavenSrc=function(t,e){var n=this.w.document.createElement("script");n.src=i,n.async=!0,n.crossOrigin="anonymous",n.onload=t,n.onerror=e,this.w.document.head.appendChild(n)},t.prototype.pushSentHistory=function(t,n){this.global.namespace()[e.SENT_TO_SENTRY]instanceof Array||(this.global.namespace()[e.SENT_TO_SENTRY]=[]),this.global.namespace()[e.SENT_TO_SENTRY].push({error:t.message||t,extra:n})},t.prototype.getAccountIdsStr=function(){var t=this.global.receivedOrders.toDebugObject();return o.option(t).map(function(t){return r.filter(t,function(t){return t&&!!t.accountId})}).map(function(t){return r.map(t,function(t){return t.accountId})}).map(function(t){return r.uniq(t)}).map(function(t){return r.sort(t)}).map(function(t){return t.join(", ")})},t}();e.RavenWrapper=a},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(5),i=function(){function t(t){r.assertNotNull(t),this.namespace=t.namespace.bind(t)}return t.prototype.setInitialDecoratorFunction=function(){this.namespace()&&!this.namespace()[o.DECORATOR]&&(this.namespace()[o.DECORATOR]=function(t){return t})},t}();e.CrossDomainTrackingInitializer=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(5),i=n(10),a=n(9),s=n(3),u=function(){function t(t){r.assertNotNull(t),this.w=t.window(),this.location=t.location,this.util=new a.CrossDomainTrackingUtil(t)}return t.prototype.getUid=function(){var t=this;return this.getUidValueFromUrl().flatMap(function(e){return i.CrossDomainId.parse(t.w,e)}).filter(function(e){var n=t.util.generateIdentifier(),r=t.util.getTimestamp();return e.shouldUpdate(n,r)}).map(function(t){return t.getUid()})},t.prototype.getUidValueFromUrl=function(){var t=this;return this.location.href().flatMap(function(e){return new s.URLWrapper(t.w,e).searchParams().map(function(t){return t.get(o.QUERY_KEY)||""})})},t}();e.CrossDomainTrackingUidReader=u},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=function(){function t(t){this.global=t,r.assertNotNull(t)}return t.prototype.activate=function(){null==this.global.namespace()[this.namespace]&&(this.global.namespace()[this.namespace]={})},t.prototype.put=function(t,e){null==this.global.namespace()[this.namespace]&&this.activate(),this.global.namespace()[this.namespace][t]=e},t.prototype.remove=function(t){null!=this.global.namespace()[this.namespace][t]&&delete this.global.namespace()[this.namespace][t]},t.prototype.pathname=function(t){return"window."+this.global.ns+"."+this.namespace+"."+t},t}();e.ObjectPool=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(1),i=n(2),a=function(){function t(t){this.global=t,this.running=!1,this.beacons=[],r.assertNotNull(t)}return t.prototype.queue=function(t){this.global.debug("BeaconQueue#queue: "+t),null!=t&&this.beacons.push(t)},t.prototype.run=function(){var t=this;this.running?this.global.debug("BeaconQueue#run: running"):(this.global.debug("BeaconQueue#run: running="+this.running+" -> true"),this.running=!0,this.global.timer.setTimeout(function(){return t.runNext()},0))},t.prototype.getBeacons=function(){return this.beacons},t.prototype.runNext=function(){try{this.global.isUidSynced()?this.runConcurrent():this.runSequential()}catch(t){this.global.logErrorThenCaptureException(t)}},t.prototype.runConcurrent=function(){this.global.debug("BeaconQueue#runConcurrent");for(var t=[],e=this.beacons.length,n=0;n<e;n++){var r=o.option(this.beacons.shift());if(r.isEmpty())break;t.push(r)}this.global.doc.fire(t),this.checkRunning()},t.prototype.runSequential=function(){var t=this;this.global.debug("BeaconQueue#runSequential");var e=o.option(this.beacons.shift()),n=function(){t.global.debug("onload fired: "+e),t.global.useTrackerResponse(),t.checkRunning()&&t.runNext()};this.global.debug("BeaconQueue#runNext: "+e),this.global.doc.fire([e],function(t){return i.setOnload(t,n)})},t.prototype.checkRunning=function(){var t=this.beacons.length;return t<=0?(this.global.debug("BeaconQueue#checkRunning: beaconLength="+t+", running="+this.running+" -> false"),this.running=!1):this.global.debug("BeaconQueue#checkRunning: beaconLength="+t+", running="+this.running),this.running},t}();e.BeaconQueue=a},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});for(var n=[],r=0;r<64;)n[r]=0|4294967296*Math.abs(Math.sin(++r));e.md5=function(t){for(var e=1732584193,r=-271733879,o=[],i=unescape(encodeURI(t)),a=i.length,s=[e,r,~e,~r],u=0;u<=a;)o[u>>2]|=(i.charCodeAt(u)||128)<<u++%4*8;var c,l=16*(a+8>>6)+14;for(o[l]=8*a,u=0;u<l;u+=16){c=s;for(var p=0;p<64;){var f=void 0;c=[f=c[3],(e=0|c[1])+((f=c[0]+[e&(r=c[2])|~e&f,f&e|~f&r,e^r^f,r^(e|~f)][a=p>>4]+(n[p]+(0|o[[p,5*p+1,3*p+5,7*p][a]%16+u])))<<(a=[7,12,17,22,5,9,14,20,4,11,16,23,6,10,15,21][4*a+p++%4])|f>>>32-a),e,r]}for(p=4;p;)s[--p]=s[p]+c[p]}for(t="",u=0;u<32;)t+=(s[u>>3]>>4*(1^7&u++)&15).toString(16);return t}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],l=!1,p=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):p=-1,c.length&&h())}function h(){if(!l){var t=s(f);l=!0;for(var e=c.length;e;){for(u=c,c=[];++p<e;)u&&u[p].run();p=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new d(t,e)),1!==c.length||l||s(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=function(){function t(t,e,n){this.global=t,this.wrapper=e,this.timeoutMsec=n,this.runNext=r.none,this.fired=!1,this.timerId=r.none}return t.prototype.wrapRunNext=function(t){var e=this;return this.runNext=r.some(t),this.timeoutMsec&&(this.timerId=r.some(this.global.timer.setTimeout(function(){e.callRunNextOnce()},this.timeoutMsec))),this.wrapper},t.prototype.callRunNextOnce=function(){var t=this;!1===this.fired&&this.runNext.forEach(function(e){t.fired=!0,t.timerId.forEach(function(e){t.global.timer.clearTimeout(e),t.timerId=r.none}),e()})},t.prototype.hasRunNext=function(){return this.runNext.isDefined()},t}();e.SequentialPingWrapper=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(29),o=n(8),i=n(6),a=n(7),s=n(20),u=n(0),c=n(15),l=function(){function t(t,e,n){this.global=t,this.report=e,this.order=n,this.dataBridgeHelper=new c.DataBridgeHelper}return t.prototype.build=function(){var t=this,e=new r.SequentialPingWrapper(this.global,function(){},3e3),n=new o.MessageBuilder(this.order.dataBridgeEndPointUrl,function(){return t.setPreventReplaceDocumentMethodsFlag(),t.dataBridgeParams(e)});return new a.Ping(n,null,e)},t.prototype.dataBridgeParams=function(t){var e=this,n=this.global.callbacks.publishId(),r=!1,o=function(){!1===r&&(r=!0,e.report.unisId=e.global.unisIdFromUnisNamespace().orElse(e.global.doc.cookie.getUnisIdCache(e.order.accountId)),e.report.unisId.forEach(function(t){return e.global.doc.cookie.putUnisIdCache(e.order.accountId,t,7776e3)}),t.callRunNextOnce(),e.global.callbacks.remove(n))};this.global.callbacks.put(n,o);var i=this.global.callbacks.pathname(n),a=this.global.jsonps.pathname(s.AdditionalTag.allocate(this.global,function(t){return t.indexOf(i)>-1},o));return u.slim({unisIdExists:this.global.doc.cookie.getUnisIdCache(this.order.accountId).exists(function(t){return""!==t})?"true":"false",matchingTagCallback:i,jsonpCallback:a,emailOrUserIdForMatching:this.order.emailOrUserIdForMatching.getOrElse(""),u1:this.global.doc.cookie.getUid(),cid1:this.global.getCid(this.order.accountId,this.order.emailOrUserIdForMatching)})},t.prototype.setPreventReplaceDocumentMethodsFlag=function(){var t=this;this.global.location.getTopLevelDomain().forEach(function(e){t.global.location.hostname().forEach(function(n){t.dataBridgeHelper.shouldPreventReplaceDocumentMethods(e,n)&&(t.global.namespace()[i.PREVENT_REPLACE_DOCUMENT_METHODS]=!0)})})},t}();e.DataBridgePingBuilder=l},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});for(var n,r=1,o=[],i=[];++r<18;)for(n=r*r;n<312;n+=r)o[n]=1;function a(t,e){return Math.pow(t,1/e)%1*4294967296|0}for(r=1,n=0;r<313;)o[++r]||(i[n]=a(r,2),o[n++]=a(r,3));function s(t,e){return t>>>e|t<<32-e}e.sha256=function(t){for(var e,a,u,c=i.slice(r=0),l=unescape(encodeURI(t)),p=[],f=l.length,h=[];r<f;)h[r>>2]|=(255&l.charCodeAt(r))<<8*(3-r++%4);for(h[(f*=8)>>5]|=128<<24-f%32,h[u=f+64>>5|15]=f,r=0;r<u;r+=16){for(e=c.slice(n=0,8);n<64;e[4]+=a)p[n]=n<16?h[n+r]:(s(a=p[n-2],17)^s(a,19)^a>>>10)+(0|p[n-7])+(s(a=p[n-15],7)^s(a,18)^a>>>3)+(0|p[n-16]),e.unshift((a=(e.pop()+(s(t=e[4],6)^s(t,11)^s(t,25))+((t&e[5]^~t&e[6])+o[n])|0)+(0|p[n++]))+(s(f=e[0],2)^s(f,13)^s(f,22))+(f&e[1]^e[1]&e[2]^e[2]&f));for(n=8;n--;)c[n]=e[n]+c[n]}for(l="";n<63;)l+=(c[++n>>3]>>4*(7-n%8)&15).toString(16);return l}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(6),o=function(){function t(t,e){this.w=t,this.ns=e,this.global=new r.Global(this.w,this.ns).activate()}return t.prototype.run=function(){var t=this;try{var e=this.createBindOrderFn();this.global.receiveOrder(e).forEach(function(e){t.global.receivedOrders.add(e),t.runAdditionalFeatures(e),t.buildBeacon(e).forEach(function(e){t.global.beacons.add(e),t.global.beacons.launch()})})}catch(t){this.global.logErrorThenCaptureException(t)}},t.prototype.createBindOrderFn=function(){throw new Error("Not implemented")},t.prototype.bindReport=function(t){throw new Error("Not implemented")},t.prototype.buildBeacon=function(t){throw new Error("Not implemented")},t.prototype.runAdditionalFeatures=function(t){},t}();e.Runner=o},function(t,e,n){(function(t){var r=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new r(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,n||[])).next())})},o=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(1),s=n(2),u=function(){function e(t,e,n,r,o){void 0===o&&(o=function(){}),this.global=t,this.callback=e,this.first=n,this.afterAllCallback=o,this.rest=a.nonEmptyOption(r).getOrElse([])}return e.prototype.run=function(e){return r(this,void 0,t,function(){var n,r,i,u,c,l,p,f,h=this;return o(this,function(d){switch(d.label){case 0:n=[this.first].concat(this.rest),r=n.pop(),i=function(e){return o(this,function(n){switch(n.label){case 0:return[4,new t(function(t){h.global.doc.fire([a.some(e)],function(n){s.setOnload(n,e.makeWrappedRunNext(t)),n.onerror=t})})];case 1:return n.sent(),u.global.useTrackerResponse(),[2]}})},u=this,c=0,l=n,d.label=1;case 1:return c<l.length?(p=l[c],[5,i(p)]):[3,4];case 2:d.sent(),d.label=3;case 3:return c++,[3,1];case 4:return f=r.run(e).then(this.afterAllCallback),this.callback(),[2,f]}})})},e.prototype.toString=function(){return i.makeJsonString({first:this.first.toString,rest:this.rest.toString})},e}();e.SequentialBeacon=u}).call(this,n(4))},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(1),i=function(){function t(t,e,n,r,o,i,a,s,u,c){this.custom1=t,this.custom2=e,this.custom3=n,this.custom4=r,this.custom5=o,this.custom6=i,this.custom7=a,this.custom8=s,this.custom9=u,this.custom10=c}return t.prototype.toJson=function(){return r.slim({c1:this.custom1,c2:this.custom2,c3:this.custom3,c4:this.custom4,c5:this.custom5,c6:this.custom6,c7:this.custom7,c8:this.custom8,c9:this.custom9,c10:this.custom10})},t.EMPTY=new t(o.none,o.none,o.none,o.none,o.none,o.none,o.none,o.none,o.none,o.none),t}();e.Customs=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=function(){function t(t){this.value=t}return t.values=function(){return[t.WEB_AD,t.WEB_KEYWORD]},t.valueOf=function(e){return r.find(t.values(),function(t){return t.value===e})},t.WEB_AD=new t("wa"),t.WEB_KEYWORD=new t("wk"),t}();e.Channel=o;var i=function(){function t(t){this.value=t}return t.values=function(){return[t.CLICK]},t.valueOf=function(e){return r.find(t.values(),function(t){return t.value===e})},t.CLICK=new t("c"),t}();e.Event=i;var a=function(){function t(t){this.value=t}return t.values=function(){return[t.DIGEST,t.PARAMETER,t.AUTO_MEASUREMENT]},t.valueOf=function(e){return r.find(t.values(),function(t){return t.value===e})},t.DIGEST=new t("d"),t.PARAMETER=new t("p"),t.AUTO_MEASUREMENT=new t("a"),t}();e.UrlType=a;var s=function(){function t(t){this.value=t}return t.values=function(){return[t.HASH,t.QUERY,t.REDIRECT]},t.valueOf=function(e){return r.find(t.values(),function(t){return t.value===e})},t.HASH=new t("h"),t.QUERY=new t("q"),t.REDIRECT=new t("r"),t}();e.DirectMeasurementType=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=function(){function t(){this.configs=[],this.activated=!1,this.inactivated=!1,this.events=[],this.shouldReport=!1}return t.prototype.onInit=function(){},t.prototype.afterActivate=function(){},t.prototype.afterInactivate=function(){},t.prototype.beforePeriodicalReport=function(){},t.prototype.onUnload=function(){},t.prototype.init=function(){this.onInit()},t.prototype.activate=function(t){var e;this.activated=!0,(e=this.configs).push.apply(e,t),this.afterActivate()},t.prototype.inactivate=function(){this.inactivated=!0,this.afterInactivate()},t.prototype.periodicalReport=function(){this.beforePeriodicalReport()},t.prototype.unload=function(){this.onUnload()},t.prototype.pushEvent=function(){for(var t,e=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];(t=this.events).push.apply(t,r.map(n,function(t){return{type:e.eventType,value:t}})),this.shouldReport=!0},t.prototype.popAllEvents=function(){return this.shouldReport=!1,this.events.splice(0,this.events.length)},t}();e.Watcher=o},,function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=function(){function t(t){this._root=r.none,this._channel=r.none,this._event=r.none,this._urlType=r.none,this._adPlanKey=r.none,this._root=r.nonEmptyOption(t)}return t.prototype.channel=function(t){return this._channel=r.nonEmptyOption(t.value),this},t.prototype.event=function(t){return this._event=r.nonEmptyOption(t.value),this},t.prototype.urlType=function(t){return this._urlType=r.nonEmptyOption(t.value),this},t.prototype.adPlanKey=function(t){return this._adPlanKey=t,this},t.prototype.build=function(){var t=this;return this._root.flatMap(function(e){return t._channel.flatMap(function(n){return t._event.flatMap(function(r){return t._urlType.map(function(t){return""+e+n+"/"+r+"/j/"+t})})})}).flatMap(function(e){return t._adPlanKey.map(function(t){return e+"/"+t}).orElse(r.some(e))})},t}();e.UrlBuilder=o},function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.trackingIdNames=["gclid"]},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(12),o=n(1),i=n(0),a=function(){function t(t){this.dm=t,this._uid1stParty=o.none,this._cid1stParty=o.none,this._referrerUrl=o.none,this._landingPageUrl=o.none,this._finalUrl=o.none}return t.prototype.accountId=function(t){return this._accountId=t,this},t.prototype.uid1stParty=function(t){return this._uid1stParty=t,this},t.prototype.cid1stParty=function(t){return this._cid1stParty=t,this},t.prototype.referrerUrl=function(t){return this._referrerUrl=t,this},t.prototype.landingPageUrl=function(t){return this._landingPageUrl=t,this},t.prototype.finalUrl=function(t){return this._finalUrl=t,this},t.prototype.build=function(){return i.slim(i.extend(new r.WebReport(this._uid1stParty,this._cid1stParty,o.none,o.none,o.none,o.none,o.none,o.none,this._referrerUrl,this._finalUrl).toJson(),this.dm.toParamJson(this._landingPageUrl.getOrElse(""),this._accountId)))},t}();e.ParamJsonBuilder=a},function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=n(1),a=n(35),s=n(40),u=n(34),c=function(){function t(t,e,n){this.directMeasurementType=t,this.trackingIdsOfAdMedia=e,this.customs=n}return t.prototype.toParamJson=function(t,e){var n=i.some(this.directMeasurementType).map(function(t){return t.value});return o.slim(o.extend(this.customs.toJson(),{dm:n,a:e},this.trackingIdsOfAdMedia))},t.prototype.paramJsonBuilder=function(){return new s.ParamJsonBuilder(this)},t}();e.DirectMeasurement=c;var l=function(t){function e(e,n,r,o){void 0===o&&(o=u.Customs.EMPTY);var i=t.call(this,n,r,o)||this;return i.adPlanKey=e,i.trackingIdsOfAdMedia=r,i.channel=a.Channel.WEB_AD,i.event=a.Event.CLICK,i.urlType=a.UrlType.DIGEST,i}return r(e,t),e}(c);e.WebAdDigest=l;var p=function(t){function e(e,n,r,o,s,c,l){void 0===l&&(l=u.Customs.EMPTY);var p=t.call(this,s,c,l)||this;return p.mediaId=e,p.campaignId=n,p.adGroupId=r,p.adId=o,p.trackingIdsOfAdMedia=c,p.channel=a.Channel.WEB_AD,p.event=a.Event.CLICK,p.urlType=a.UrlType.PARAMETER,p.adPlanKey=i.none,p}return r(e,t),e.prototype.toParamJson=function(e,n){return o.slim(o.extend(t.prototype.toParamJson.call(this,e,n),{md:this.mediaId,cp:this.campaignId,agr:this.adGroupId,ad:this.adId}))},e}(c);e.WebAdParameter=p;var f=function(t){function e(e,n,r,o,s,c,l){void 0===l&&(l=u.Customs.EMPTY);var p=t.call(this,s,c,l)||this;return p.mediaId=e,p.campaignId=n,p.adGroupName=r,p.adName=o,p.trackingIdsOfAdMedia=c,p.channel=a.Channel.WEB_AD,p.event=a.Event.CLICK,p.urlType=a.UrlType.AUTO_MEASUREMENT,p.adPlanKey=i.none,p}return r(e,t),e.prototype.toParamJson=function(e,n){return o.slim(o.extend(t.prototype.toParamJson.call(this,e,n),{md:this.mediaId,cp:this.campaignId,agr:this.adGroupName,ad:this.adName,lp:e}))},e}(c);e.WebAdAuto=f;var h=function(t){function e(e,n,r,o){void 0===o&&(o=u.Customs.EMPTY);var i=t.call(this,n,r,o)||this;return i.adPlanKey=e,i.trackingIdsOfAdMedia=r,i.channel=a.Channel.WEB_KEYWORD,i.event=a.Event.CLICK,i.urlType=a.UrlType.DIGEST,i}return r(e,t),e}(c);e.WebKeywordDigest=h;var d=function(t){function e(e,n,r,o,s,c,l){void 0===l&&(l=u.Customs.EMPTY);var p=t.call(this,s,c,l)||this;return p.mediaId=e,p.campaignId=n,p.adGroupId=r,p.keywordId=o,p.trackingIdsOfAdMedia=c,p.channel=a.Channel.WEB_KEYWORD,p.event=a.Event.CLICK,p.urlType=a.UrlType.PARAMETER,p.adPlanKey=i.none,p}return r(e,t),e.prototype.toParamJson=function(e,n){return o.slim(o.extend(t.prototype.toParamJson.call(this,e,n),{md:this.mediaId,cp:this.campaignId,agr:this.adGroupId,kw:this.keywordId}))},e}(c);e.WebKeywordParameter=d;var g=function(t){function e(e,n,r,o,s,c,l,p){void 0===p&&(p=u.Customs.EMPTY);var f=t.call(this,c,l,p)||this;return f.mediaId=e,f.campaignId=n,f.adGroupName=r,f.keyword=o,f.matchTypeId=s,f.trackingIdsOfAdMedia=l,f.channel=a.Channel.WEB_KEYWORD,f.event=a.Event.CLICK,f.urlType=a.UrlType.AUTO_MEASUREMENT,f.adPlanKey=i.none,f}return r(e,t),e.prototype.toParamJson=function(e,n){return o.slim(o.extend(t.prototype.toParamJson.call(this,e,n),{md:this.mediaId,cp:this.campaignId,agr:this.adGroupName,kw:this.keyword,mt:this.matchTypeId,lp:e}))},e}(c);e.WebKeywordAuto=g},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(1),i=n(35),a=n(41),s=n(34),u=n(39),c=function(){function t(){}return t.split=function(t){var e=t.indexOf("#"),n=-1===e?"":t.substring(e+1),r=-1===e?t:t.substring(0,e),i=r.indexOf("?"),a=-1===i?"":r.substring(i+1);return{query:o.nonEmptyOption(a),hash:o.nonEmptyOption(n)}},t}();e.UrlParamHashSplitter=c;var l=function(){function t(){}return t.parse=function(t){var e=c.split(t),n=e.query;return e.hash.flatMap(function(t){return function(t,e){var n=t.split("_");if(n.length<4)return o.none;if(n.length%2!=0)return o.none;if("adp"!==n[0])return o.none;for(var r={},a=4;a<n.length;a+=2){if(null!=r[n[a]])return o.none;r[n[a]]=n[a+1]}var s=i.Channel.valueOf(n[1]),u=i.Event.valueOf(n[2]),c=i.UrlType.valueOf(n[3]),l=h(f(e)),p=new v(r),g={adPlanKey:"d",mediaId:"md",campaignId:"cp",adGroupId:"agr",adGroupName:"agr",adId:"ad",adName:"ad",keywordId:"kw",keyword:"kw",matchTypeId:"mt",directMeasurementType:"dm",custom1:"c1",custom2:"c2",custom3:"c3",custom4:"c4",custom5:"c5",custom6:"c6",custom7:"c7",custom8:"c8",custom9:"c9",custom10:"c10"},m=p.get(g.directMeasurementType).flatMap(function(t){return i.DirectMeasurementType.valueOf(t)}).getOrElse(i.DirectMeasurementType.HASH);return s.flatMap(function(t){return u.flatMap(function(e){return c.flatMap(function(e){return d(t,e,p,g,l,m)})})})}(t,n.getOrElse(""))}).orElseLazy(function(){return n.flatMap(p)})},t}();function p(t){var e=f(t),n=i.Channel.valueOf(e._adp_c),r=i.Event.valueOf(e._adp_e),o=i.UrlType.valueOf(e._adp_u),a=h(e),s=new v(e),u=function(t,e){for(var n in t)t.hasOwnProperty(n)&&(t[n]=e(t[n]));return t}({adPlanKey:"d",mediaId:"md",campaignId:"cp",adGroupId:"agr",adGroupName:"agr",adId:"ad",adName:"ad",keywordId:"kw",keyword:"kw",matchTypeId:"mt",directMeasurementType:"dm",custom1:"c1",custom2:"c2",custom3:"c3",custom4:"c4",custom5:"c5",custom6:"c6",custom7:"c7",custom8:"c8",custom9:"c9",custom10:"c10"},function(t){return"_adp_p_"+t}),c=s.get(u.directMeasurementType).flatMap(function(t){return i.DirectMeasurementType.valueOf(t)}).getOrElse(i.DirectMeasurementType.QUERY);return n.flatMap(function(t){return r.flatMap(function(e){return o.flatMap(function(e){return d(t,e,s,u,a,c)})})})}function f(t){if(void 0===t)return{};for(var e={},n=0,r=t.split("&");n<r.length;n++){var o=r[n].split("=");e[o[0]]=o[1]}return e}function h(t){var e={};return u.trackingIdNames.forEach(function(n){n in t&&(e[n]=t[n])}),e}function d(t,e,n,r,s,u){return t===i.Channel.WEB_AD?e===i.UrlType.DIGEST?o.some(new a.WebAdDigest(n.get(r.adPlanKey),u,s,g(n,r))):e===i.UrlType.PARAMETER?o.some(new a.WebAdParameter(n.get(r.mediaId),n.get(r.campaignId),n.get(r.adGroupId),n.get(r.adId),u,s,g(n,r))):e===i.UrlType.AUTO_MEASUREMENT?o.some(new a.WebAdAuto(n.get(r.mediaId),n.get(r.campaignId),n.getDecoded(r.adGroupName),n.getDecoded(r.adName),u,s,g(n,r))):o.none:t===i.Channel.WEB_KEYWORD?e===i.UrlType.DIGEST?o.some(new a.WebKeywordDigest(n.get(r.adPlanKey),u,s,g(n,r))):e===i.UrlType.PARAMETER?o.some(new a.WebKeywordParameter(n.get(r.mediaId),n.get(r.campaignId),n.get(r.adGroupId),n.get(r.keywordId),u,s,g(n,r))):e===i.UrlType.AUTO_MEASUREMENT?o.some(new a.WebKeywordAuto(n.get(r.mediaId),n.get(r.campaignId),n.getDecoded(r.adGroupName),n.getDecoded(r.keyword),n.get(r.matchTypeId),u,s,g(n,r))):o.none:o.none}function g(t,e){return new s.Customs(t.get(e.custom1),t.get(e.custom2),t.get(e.custom3),t.get(e.custom4),t.get(e.custom5),t.get(e.custom6),t.get(e.custom7),t.get(e.custom8),t.get(e.custom9),t.get(e.custom10))}e.DirectMeasurementFactory=l,e.parseQueryParameter=f;var v=function(){function t(t){this.params=t}return t.prototype.get=function(t){return o.option(this.params[t])},t.prototype.getDecoded=function(t){return this.get(t).map(function(t){return r.decodeURIComponentOrNot(t)})},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(7),o=n(42),i=n(38),a=n(8),s=function(){function t(t){this.global=t}return t.prototype.buildPing=function(t,e,n,s,u){var c=this;return u.flatMap(function(t){return o.DirectMeasurementFactory.parse(t)}).flatMap(function(r){return e.flatMap(function(e){return new i.UrlBuilder(e).channel(r.channel).event(r.event).urlType(r.urlType).adPlanKey(r.adPlanKey).build().map(function(e){return new a.MessageBuilder(e,function(){return r.paramJsonBuilder().accountId(t).uid1stParty(c.global.doc.cookie.getUid()).cid1stParty(c.global.getCid(t,n)).referrerUrl(s).landingPageUrl(u).finalUrl(c.global.location.href()).build()})})})}).map(function(t){return new r.Ping(t)})},t}();e.DirectMeasurementPingFactory=s},function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),i=function(t){function e(e){var n=t.call(this)||this;return n.global=e,n.eventType="page_duration",n.duration=0,n.history=[],n.hasNewEntry=!1,n.onVisibilityChange=function(){return n.addNewEntry(!1)},n}return r(e,t),Object.defineProperty(e.prototype,"shouldReport",{get:function(){return this.hasNewEntry||"foreground"===this.previousEntry.event},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentVisibility",{get:function(){return this.global.doc.hidden?"background":"foreground"},enumerable:!0,configurable:!0}),e.prototype.onInit=function(){var t=this.global.window().performance,e=o.option(t).filter(function(t){return"function"==typeof t.getEntriesByType&&"number"==typeof t.timeOrigin}).flatMap(function(t){return o.option(t.getEntriesByType("navigation")[0]).filter(function(t){return!!t.domContentLoadedEventEnd}).map(function(e){return Math.floor(t.timeOrigin+e.domContentLoadedEventEnd)})}).getOrElse(Date.now());this.previousEntry={event:this.currentVisibility,timestamp:e},this.addNewEntry(!1),this.global.doc.addEventListener("visibilitychange",this.onVisibilityChange)},e.prototype.afterInactivate=function(){this.global.doc.removeEventListener("visibilitychange",this.onVisibilityChange)},e.prototype.addNewEntry=function(t){var e=Date.now();"foreground"===this.previousEntry.event&&(this.duration+=e-this.previousEntry.timestamp);var n={event:this.currentVisibility,timestamp:e};this.history.push(n),this.previousEntry=n,this.hasNewEntry=!0},e.prototype.popAllEvents=function(){return this.hasNewEntry=!1,t.prototype.popAllEvents.call(this)},e.prototype.createEventValue=function(t){return{duration:"foreground"===this.previousEntry.event?this.duration+Date.now()-this.previousEntry.timestamp:this.duration,history:this.history.slice(),final:t}},e.prototype.beforePeriodicalReport=function(){this.shouldReport&&this.pushEvent(this.createEventValue(!1))},e.prototype.onUnload=function(){this.pushEvent(this.createEventValue(!0)),this.global.doc.removeEventListener("visibilitychange",this.onVisibilityChange)},e}(n(36).Watcher);e.PageDurationWatcher=i},function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),i=n(0),a=n(36),s=function(){function t(t,e,n){this.window=t,this.el=e,this.config=n,this.state={ratio:0,pixels:0,top:0,bottom:0}}return t.prototype.update=function(){var t=this.window.innerHeight,e=this.el.getBoundingClientRect(),n=e.top,r=e.bottom,o=e.width,i=e.height;this.state.pixels=o*i,this.state.ratio=Math.max(this.state.ratio,t<=n?0:r<=t?1:(t-n)/i);var a=this.window.document.documentElement.scrollTop||this.window.document.body.scrollTop||this.window.pageYOffset||this.window.scrollY||0;this.state.top=a+n,this.state.bottom=a+r},t}();e.AreaState=s;var u=function(){function t(t,e){this.config=t,this.areas=e}return t.prototype.update=function(){i.each(this.areas,function(t){return t.update()})},t.prototype.getEventValue=function(t){var e=this,n=i.sum(i.map(this.areas,function(t){return t.state.pixels}));return{config:this.config,top:Math.min.apply(Math,i.map(this.areas,function(t){return t.state.top})),bottom:Math.max.apply(Math,i.map(this.areas,function(t){return t.state.bottom})),ratio:i.sum(i.map(this.areas,function(t){return t.state.ratio*(n?t.state.pixels/n:1/e.areas.length)})),areas:i.map(this.areas,function(t){return t.state}),final:t}},t}();e.EventValueGenerator=u;var c=function(t){function e(n){var r=t.call(this)||this;return r.global=n,r.eventType="reading",r.generators=[],r.lastUpdateTime=0,r.onScroll=function(t){t.timeStamp<r.lastUpdateTime+e.throttleMs||(r.update(),r.lastUpdateTime=t.timeStamp)},r}return r(e,t),e.prototype.startObserving=function(){this.global.window().addEventListener("scroll",this.onScroll,{passive:!0}),this.global.window().addEventListener("resize",this.onScroll,{passive:!0})},e.prototype.stopObserving=function(){this.global.window().removeEventListener("scroll",this.onScroll),this.global.window().removeEventListener("resize",this.onScroll)},e.prototype.createEventValues=function(t){return i.map(this.generators,function(e){return e.getEventValue(t)})},e.prototype.update=function(){i.each(this.generators,function(t){return t.update()}),this.shouldReport=!0},e.prototype.afterActivate=function(){var t=this;this.configs.forEach(function(n){t.global.doc.querySelectorAll(n.readingSelector||e.defaultSelector).filter(function(t){return 0<t.length}).map(o.toArray).map(function(e){return i.map(e,function(e){return new s(t.global.window(),e,n)})}).forEach(function(e){return t.generators.push(new u(n,e))})}),this.generators.length&&(this.update(),this.startObserving())},e.prototype.beforePeriodicalReport=function(){this.shouldReport&&this.pushEvent.apply(this,this.createEventValues(!1))},e.prototype.onUnload=function(){this.stopObserving(),this.pushEvent.apply(this,this.createEventValues(!0))},e.defaultSelector="body",e.throttleMs=1e3,e}(a.Watcher);e.ReadingWatcher=c},function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(12),i=n(0),a=function(t){function e(e,n,r,o,i,a,s,u,c,l,p,f){var h=t.call(this,e,n,r,o,i,a,s,u,c,l)||this;return h.specificParameters=p,h.pvDetail=f,h}return r(e,t),e.prototype.toJson=function(){return i.slim(i.extend(t.prototype.toJson.call(this),{sp:this.specificParameters,pd:this.pvDetail}))},e}(o.WebReport);e.WebSiteReport=a},function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),i=n(16),a=n(11),s=function(t){function e(e,n,r,o,i,s,u,c,l,p,f,h,d,g,v,m){var y=t.call(this,e,r,o,i,s,u,c,l,p,f,h,d)||this;if(y.trackerUrl=n,y.trackerRootUrl=g,y.specificParameters=v,y.pvDetail=m,null==n)throw new a.IllegalOrderError(y.constructor.toString()+": trackerUrl is undefined");return y}return r(e,t),Object.defineProperty(e.prototype,"siteEventEndpointUrl",{get:function(){var t=this;return this.trackerRootUrl.map(function(e){return e+"ws/e/"+t.accountId})},enumerable:!0,configurable:!0}),e.bind=function(t){return null!=t&&t.s===e.SCRIPT_ID?o.some(new e(t.a,t.u,t.db,o.nonEmptyOption(t.cd),o.nonEmptyOption(t.cdExcludes),o.nonEmptyOption(t.emailOrUserIdForMatching),o.nonEmptyOption(t.segments),o.nonEmptyOption(t.unisId),o.nonEmptyOption(t.idfa),o.nonEmptyOption(t.advertisingId),o.nonEmptyOption(t.title),o.nonEmptyOption(t.locationUrl),o.nonEmptyOption(t.refererUrl),o.nonEmptyOption(t.d),o.option(t.specificParameters),o.option(t.pvDetail))):o.none},e.SCRIPT_ID="ws",e}(i.DataBridgeOrder);e.WebSiteOrder=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=function(){function t(t,e){this.pvEventId=t,this.events=e}return t.prototype.toJson=function(){return r.slim({pe:this.pvEventId,e:r.makeJsonString(this.events)})},t}();e.SiteEventReport=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),o=n(7),i=n(13),a=n(0),s=n(14),u=n(48),c=function(){function t(t,e,n){var o=this;this.global=t,this.endpointUrl=e,this.watchers=n,this.unloadListener=function(){return o.unload()},this.builder=new r.MessageBuilder(e,function(){return o.createReport().toJson()}),a.each(n,function(t){return t.init()})}return t.prototype.activate=function(t){var e=this;this.eventId=t.eventId,this.timerId=this.global.timer.setInterval(function(){return e.periodicalReport()},6e4),this.global.window().addEventListener("unload",this.unloadListener);var n=this.global.location.href(),r=t.siteEventConfig.filter(function(t){return s.isActiveConfig(t,n)});a.each(this.watchers,function(t){return t.activate(r)})},t.prototype.inactivate=function(){a.each(this.watchers,function(t){return t.inactivate()})},t.prototype.createReport=function(){var t=[];return a.each(this.watchers,function(e){e.shouldReport&&(t.push.apply(t,e.popAllEvents()),e.shouldReport=!1)}),new u.SiteEventReport(this.eventId,t)},t.prototype.createBeacon=function(){return new i.SingleBeacon(this.global,null,new o.Ping(this.builder))},t.prototype.sendBeacon=function(){var t=this;this.createBeacon().run(function(e){t.global.navigator.sendBeacon(e)||t.global.doc.loadScriptAsync(e)})},t.prototype.periodicalReport=function(){a.each(this.watchers,function(t){return t.periodicalReport()}),a.exists(this.watchers,function(t){return t.shouldReport})&&this.sendBeacon()},t.prototype.unload=function(){this.global.timer.clearInterval(this.timerId),this.global.window().removeEventListener("unload",this.unloadListener),a.each(this.watchers,function(t){return t.unload()}),this.sendBeacon()},t}();e.SiteEventService=c},function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),i=n(0),a=n(36);function s(t,e){var n={configName:e,timestamp:Date.now(),tag:t.tagName.toLocaleLowerCase(),text:i.trim(t.textContent||"")||void 0,attributes:{}};return i.each(t.attributes,function(t){n.attributes[t.name]=t.value}),(u(t,"a")||u(t,"area"))&&(n.url=t.href),n}function u(t,e){return 0===(t.localName+":").indexOf(e+":")}e.createEventValue=s,e.is=u;var c=function(t){function e(e){var n=t.call(this)||this;return n.global=e,n.eventType="click",n.queue=[],n.onClick=function(t){o.getTarget(t).filter(o.isElement).forEach(function(t){n.activated?n.onClickElement(t):n.queue.push(t)})},n}return r(e,t),e.prototype.onInit=function(){this.configs.push(e.defaultConfig),this.global.doc.addEventListener("click",this.onClick,!0)},e.prototype.onClickElement=function(t){var e=this;i.each(this.configs,function(n){var r=n.name,i=n.clickSelector;i&&o.closest(t,i).map(function(t){return s(t,r)}).forEach(function(t){return e.pushEvent(t)})})},e.prototype.afterActivate=function(){var t=this;i.each(this.queue,function(e){return t.onClickElement(e)}),this.queue.length=0},e.prototype.afterInactivate=function(){this.global.doc.removeEventListener("click",this.onClick,!0),this.queue.length=0},e.defaultConfig={name:"default",pattern:["**"],clickSelector:"a, area",status:1},e}(a.Watcher);e.ClickWatcher=c},function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(30),i=n(8),a=n(7),s=n(43),u=n(5),c=n(33),l=n(50),p=n(49),f=n(1),h=n(0),d=n(47),g=n(46),v=n(32),m=n(45),y=n(44),b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.siteEventService=f.none,e}return r(e,t),e.prototype.createBindOrderFn=function(){return function(t){return d.WebSiteOrder.bind(t)}},e.prototype.bindReport=function(t){return new g.WebSiteReport(f.none,f.none,t.segments,t.unisId,t.idfa,t.advertisingId,t.title.orElse(this.global.doc.title()),t.locationUrl.orElse(this.global.location.href()),t.referrerUrl.orElse(this.global.doc.referrerUrl()),this.global.location.href(),t.specificParameters.map(function(t){return h.makeJsonString(t)}),t.pvDetail.map(function(t){return h.makeJsonString(t)}))},e.prototype.buildBeacon=function(t){var e=this,n=this.bindReport(t),r=[],u=new s.DirectMeasurementPingFactory(this.global).buildPing(t.accountId,t.trackerRootUrl,t.emailOrUserIdForMatching,n.referrerUrl,n.locationUrl),l=new o.DataBridgePingBuilder(this.global,n,t).build(),p=new a.Ping(new i.MessageBuilder(t.trackerUrl,function(){return n.uid1stParty=e.global.doc.cookie.getUid(),n.cid1stParty=e.global.getCid(t.accountId,t.emailOrUserIdForMatching),n.toJson()}));u.forEach(function(t){return r.push(t)}),r.push(l),r.push(p);var h=r[0],d=r.slice(1);return f.some(new c.SequentialBeacon(this.global,function(){return e.global.done.add(t)},h,d,function(){e.siteEventService.forEach(function(t){e.global.res.webSiteResponse().fold(function(){return t.inactivate()},function(e){return t.activate(e)})})}))},e.prototype.runAdditionalFeatures=function(t){var e=this;new u.CrossDomainTrackingRegister(this.global).activate(t.crossDomainTargets,t.crossDomainExcludes),t.siteEventEndpointUrl.forEach(function(t){e.siteEventService=f.some(new p.SiteEventService(e.global,t,[new y.PageDurationWatcher(e.global),new l.ClickWatcher(e.global),new m.ReadingWatcher(e.global)]))})},e}(v.Runner);e.WebSiteRunner=b},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),new(n(51).WebSiteRunner)(window,"_adp").run()}]);